<tr class="{% if p.promotion_status not in ['none', 'eliminated'] %}table-warning{% endif %}">
    <td>
        <input type="checkbox" name="selected_players" value="{{ p.id }}">
    </td>
    <td>{{ p.id }}</td>
    <td>{{ p.name }}</td>
    <td>{{ p.rating }}</td>
    <td>
        <select class="form-select form-select-sm" name="group_{{ p.id }}">
            <option value="beginner" {% if p.group=='beginner' %}selected{% endif %}>èŒæ–°ç»„</option>
            <option value="advanced" {% if p.group=='advanced' %}selected{% endif %}>è¿›é˜¶ç»„</option>
            <option value="peak" {% if p.group=='peak' %}selected{% endif %}>å·…å³°ç»„</option>
        </select>
    </td>
    <td>
        {% if p.checked_in %}
        <span class="badge bg-success">å·²ç­¾åˆ°</span>
        {% else %}
        <span class="badge bg-secondary">æœªåˆ°</span>
        {% endif %}
    </td>
    <td>
        {% if p.on_machine %}
        <span class="badge bg-danger">ğŸ’» ä¸Šæœºä¸­</span>
        {% else %}
        <span class="badge bg-dark">é—²ç½®</span>
        {% endif %}
    </td>
    <td style="max-width:80px;">
        <input type="number" class="form-control form-control-sm"
            name="match_number_{{ p.id }}"
            value="{{ p.match_number if p.match_number is not none else '' }}">
    </td>
    <td style="max-width:90px;">
        <input type="number" step="any" class="form-control form-control-sm"
            name="score_round1_{{ p.id }}"
            value="{{ p.score_round1 if p.score_round1 is not none else '' }}">
    </td>
    {% if p.group != 'peak' %}
    <td style="max-width:90px;">
        <input type="number" step="any" class="form-control form-control-sm"
            name="score_revival_{{ p.id }}"
            value="{{ p.score_revival if p.score_revival is not none else '' }}">
    </td>
    {% endif %}

    {% if p.group == 'advanced' %}
    <!-- è¿›é˜¶ç»„ï¼š16â†’8 / 8â†’4 -->
    <td style="max-width:120px;">
        {% if p.promotion_status in ['top16', 'top16_out', 'top8', 'top8_out'] %}
        <select class="form-select form-select-sm" name="ko16_8_result_{{ p.id }}">
            <option value="">æ— </option>
            <option value="to8">æ™‹çº§ 8 å¼º</option>
            <option value="out16">æ·˜æ±°</option>
        </select>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    <td style="max-width:120px;">
        {% if p.promotion_status in ['top8', 'top8_out', 'top4', 'third', 'fourth', 'runner_up', 'champion'] %}
        <select class="form-select form-select-sm" name="ko8_4_result_{{ p.id }}">
            <option value="">æ— </option>
            <option value="to4">æ™‹çº§ 4 å¼º</option>
            <option value="out8">æ·˜æ±°</option>
        </select>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    {% elif p.group == 'beginner' %}
    <!-- èŒæ–°ç»„ï¼š8â†’4 / 4â†’2 -->
    <td style="max-width:120px;">
        {% if p.promotion_status in ['top8', 'top8_out', 'top4'] %}
        <select class="form-select form-select-sm" name="ko8_4_result_{{ p.id }}">
            <option value="">æ— </option>
            <option value="to4">æ™‹çº§ 4 å¼º</option>
            <option value="out8">æ·˜æ±°</option>
        </select>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    <td style="max-width:120px;">
        {% if p.promotion_status in ['top4'] %}
        <select class="form-select form-select-sm" name="ko4_2_result_{{ p.id }}">
            <option value="">æ— </option>
            <option value="to_final">æ™‹çº§ å†³èµ›</option>
            <option value="out4">æ·˜æ±°</option>
        </select>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    {% else %}
    <!-- å·…å³°ç»„ï¼šä»… 4â†’2 -->
    <td style="max-width:120px;">
        {% if p.promotion_status in ['top4_peak'] %}
        <select class="form-select form-select-sm" name="ko4_2_result_{{ p.id }}">
            <option value="">æ— </option>
            <option value="to_final">æ™‹çº§ å†³èµ›</option>
            <option value="out4">æ·˜æ±°</option>
        </select>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    {% endif %}
    <td style="min-width:180px;">
        <select class="form-select form-select-sm" name="status_{{ p.id }}">
            <option value="none" {% if p.promotion_status=='none' %}selected{% endif %}>æœªæ™‹çº§ / æœªè®¾ç½®</option>
            
            {% if p.group == 'beginner' %}
                <!-- èŒæ–°ç»„ -->
                <option value="revival" {% if p.promotion_status=='revival' %}selected{% endif %}>å¤æ´»èµ›</option>
                <option value="top8" {% if p.promotion_status=='top8' %}selected{% endif %}>æœ¬ç»„ 8 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="top8_out" {% if p.promotion_status=='top8_out' %}selected{% endif %}>8 å¼ºè½è´¥</option>
                <option value="top4" {% if p.promotion_status=='top4' %}selected{% endif %}>æœ¬ç»„ 4 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="final" {% if p.promotion_status=='final' %}selected{% endif %}>æœ¬ç»„å†³èµ›ï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="third" {% if p.promotion_status=='third' %}selected{% endif %}>å­£å†›</option>
                <option value="fourth" {% if p.promotion_status=='fourth' %}selected{% endif %}>æ®¿å†›</option>
                <option value="runner_up" {% if p.promotion_status=='runner_up' %}selected{% endif %}>äºšå†›</option>
                <option value="champion" {% if p.promotion_status=='champion' %}selected{% endif %}>å† å†›</option>

            {% elif p.group == 'peak' %}
                <!-- å·…å³°ç»„ -->
                <option value="top4_peak" {% if p.promotion_status=='top4_peak' %}selected{% endif %}>æœ¬ç»„ 4 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="final" {% if p.promotion_status=='final' %}selected{% endif %}>æœ¬ç»„å†³èµ›ï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="third" {% if p.promotion_status=='third' %}selected{% endif %}>å­£å†›</option>
                <option value="runner_up" {% if p.promotion_status=='runner_up' %}selected{% endif %}>äºšå†›</option>
                <option value="champion" {% if p.promotion_status=='champion' %}selected{% endif %}>å† å†›</option>

            {% else %}
                <!-- è¿›é˜¶ç»„ (é»˜è®¤) -->
                <option value="revival" {% if p.promotion_status=='revival' %}selected{% endif %}>å¤æ´»èµ›</option>
                <option value="top16" {% if p.promotion_status=='top16' %}selected{% endif %}>æœ¬ç»„ 16 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="top16_out" {% if p.promotion_status=='top16_out' %}selected{% endif %}>16 å¼ºè½è´¥</option>
                <option value="top8" {% if p.promotion_status=='top8' %}selected{% endif %}>æœ¬ç»„ 8 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="top8_out" {% if p.promotion_status=='top8_out' %}selected{% endif %}>8 å¼ºè½è´¥</option>
                <option value="top4" {% if p.promotion_status=='top4' %}selected{% endif %}>æœ¬ç»„ 4 å¼ºï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="final" {% if p.promotion_status=='final' %}selected{% endif %}>æœ¬ç»„å†³èµ›ï¼ˆè¿›è¡Œä¸­ï¼‰</option>
                <option value="third" {% if p.promotion_status=='third' %}selected{% endif %}>å­£å†›</option>
                <option value="fourth" {% if p.promotion_status=='fourth' %}selected{% endif %}>æ®¿å†›</option>
                <option value="runner_up" {% if p.promotion_status=='runner_up' %}selected{% endif %}>äºšå†›</option>
                <option value="champion" {% if p.promotion_status=='champion' %}selected{% endif %}>å† å†›</option>
            {% endif %}

            <option value="eliminated" {% if p.promotion_status=='eliminated' %}selected{% endif %}>æ·˜æ±°</option>
        </select>
    </td>
    <td>
        <button type="button" class="btn btn-outline-danger btn-sm p-1"
            style="line-height:1;" title="åˆ é™¤é€‰æ‰‹"
            onclick="deletePlayer('{{ p.id }}', '{{ p.name }}')">
            Ã—
        </button>
    </td>
</tr>
